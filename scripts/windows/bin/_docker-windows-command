#!/bin/zsh

COMMAND="$1"
shift 1

# extract variables
read -r drive newPath <<<`realpath . | sed -r 's|^/mnt(/(\w)/.*)|\2 \1|'`


# create and bind the drive
[ ! -e "/$drive" ] && \
  sudo mkdir "/$drive" 2>/dev/null

[ -z "`ls "/$drive"`" ] && \
  sudo mount --bind "/mnt/$drive" "/$drive"


# execute command through the docker mount point
(cd "$newPath"; "$COMMAND" "$@")
